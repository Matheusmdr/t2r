import{c as B,r as D,j as t,a as H}from"./app-C3ZLcZrW.js";import{c as J,B as T}from"./index-U7aP1YJ6.js";import{F as E,d as M,e as A,f as L,g as U,a as O,o as V,u as W,b as X,c as K,i as Q,s as F,n as Y,_ as q}from"./schemas-DkqE46Vg.js";import{I as Z}from"./input-DzWqFSZJ.js";import{S as ee,a as te,b as re,c as se,d as oe}from"./select-gmWaiSlG.js";import{M as ie}from"./md-editor-field-Cg9dXzC0.js";import{U as le}from"./index-B59d0N1V.js";import{X as ae}from"./x-Dk_-pDLn.js";import{c as ne}from"./createLucideIcon-Cg1Ezlhx.js";const ce=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],de=ne("ImagePlus",ce);function me(s){const e=B.c(7),{form:r,name:f,label:u,className:h}=s,a=D.useRef(null);let c;e[0]!==h||e[1]!==u?(c=I=>{const{field:n}=I,i=Array.isArray(n.value)?n.value:[],S=d=>{const l=d.target.files;if(l&&l.length>0){const m=Array.from(l).map(ue);n.onChange([...i,...m])}a.current&&(a.current.value="")},x=d=>{const l=i.filter((m,g)=>g!==d);n.onChange(l)},o=()=>{a.current?.click()};return t.jsxs(M,{className:J("flex flex-col gap-2",h),children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(A,{children:u}),i.length>0&&t.jsxs("span",{className:"text-xs text-muted-foreground",children:[i.length," ",i.length===1?"imagem":"imagens"]})]}),t.jsx(L,{children:t.jsxs("div",{className:"space-y-4",children:[i.length>0&&t.jsx("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:i.map((d,l)=>t.jsxs("div",{className:"group relative aspect-square overflow-hidden rounded-md border bg-background",children:[t.jsx("img",{src:d.preview,alt:`Preview ${l}`,className:"h-full w-full object-cover transition-transform group-hover:scale-105"}),t.jsx("div",{className:"absolute top-1 right-1 opacity-0 transition-opacity group-hover:opacity-100",children:t.jsx(T,{type:"button",variant:"destructive",size:"icon",className:"h-6 w-6 rounded-full",onClick:()=>x(l),children:t.jsx(ae,{className:"h-3 w-3"})})})]},l))}),t.jsxs("div",{onClick:o,className:"flex cursor-pointer flex-col items-center justify-center gap-2 rounded-lg border-2 border-dashed border-muted-foreground/25 p-8 text-muted-foreground transition-colors hover:border-primary/50 hover:bg-muted/50",children:[t.jsx("div",{className:"rounded-full bg-background p-3 shadow-sm",children:t.jsx(de,{className:"h-6 w-6"})}),t.jsxs("div",{className:"text-center",children:[t.jsx("span",{className:"font-semibold text-foreground",children:"Clique para adicionar"})," ","ou arraste imagens"]}),t.jsx("p",{className:"text-xs",children:"Suporta múltiplos arquivos (JPG, PNG, WEBP)"})]}),t.jsx("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",ref:a,onChange:S})]})}),t.jsx(U,{})]})},e[0]=h,e[1]=u,e[2]=c):c=e[2];let p;return e[3]!==r.control||e[4]!==f||e[5]!==c?(p=t.jsx(E,{control:r.control,name:f,render:c}),e[3]=r.control,e[4]=f,e[5]=c,e[6]=p):p=e[6],p}function ue(s){return{preview:URL.createObjectURL(s),file:s}}const pe=V({title:F().min(1,"Título obrigatório"),product_category_id:F().min(1,"Selecione uma categoria"),sku:F().optional(),description:F().optional(),coverImage:V({preview:F(),file:q(File).optional()}).refine(s=>s.preview!=="","Imagem obrigatória"),gallery_images:Q(V({preview:F(),file:q(File).optional(),id:Y().optional()})).optional(),is_active:K().optional()});function Se(s){const e=B.c(46),{data:r,categories:f}=s;let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u=O(pe),e[0]=u):u=e[0];const h=r?.title??"";let a;e[1]!==r?.product_category_id?(a=r?.product_category_id.toString()??"",e[1]=r?.product_category_id,e[2]=a):a=e[2];const c=r?.sku??"",p=r?.description??"",I=r?.cover_image??"";let n;e[3]!==I?(n={preview:I,file:void 0},e[3]=I,e[4]=n):n=e[4];let i;e[5]!==r?(i=r?.gallery_images?r.gallery_images.map(je):[],e[5]=r,e[6]=i):i=e[6];const S=r?.is_active??!0;let x;e[7]!==h||e[8]!==a||e[9]!==c||e[10]!==p||e[11]!==n||e[12]!==i||e[13]!==S?(x={resolver:u,defaultValues:{title:h,product_category_id:a,sku:c,description:p,coverImage:n,gallery_images:i,is_active:S}},e[7]=h,e[8]=a,e[9]=c,e[10]=p,e[11]=n,e[12]=i,e[13]=S,e[14]=x):x=e[14];const o=W(x);let d;e[15]!==r?(d=function(C){const z=r?`/admin/products/${r.id}`:"/admin/products",G=C.gallery_images?.map(xe).filter(he);console.log(G),H.post(z,{...C,cover_image:C.coverImage.file,gallery_images:G,_method:r?"put":"post"})},e[15]=r,e[16]=d):d=e[16];const l=d;let m;e[17]!==o||e[18]!==l?(m=o.handleSubmit(l),e[17]=o,e[18]=l,e[19]=m):m=e[19];let g;e[20]!==o.control?(g=t.jsx(E,{control:o.control,name:"title",render:fe}),e[20]=o.control,e[21]=g):g=e[21];let j;e[22]!==f?(j=$=>{const{field:C}=$;return t.jsxs(M,{children:[t.jsx(A,{children:"Categoria"}),t.jsxs(ee,{onValueChange:C.onChange,defaultValue:C.value,children:[t.jsx(L,{children:t.jsx(te,{children:t.jsx(re,{placeholder:"Selecione..."})})}),t.jsx(se,{children:f.map(ge)})]}),t.jsx(U,{})]})},e[22]=f,e[23]=j):j=e[23];let v;e[24]!==o.control||e[25]!==j?(v=t.jsx(E,{control:o.control,name:"product_category_id",render:j}),e[24]=o.control,e[25]=j,e[26]=v):v=e[26];let _;e[27]!==g||e[28]!==v?(_=t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g,v]}),e[27]=g,e[28]=v,e[29]=_):_=e[29];let y;e[30]!==o?(y=t.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[t.jsx(le,{form:o,name:"coverImage",label:"Imagem Principal"}),t.jsx(me,{form:o,name:"gallery_images",label:"Galeria de Imagens"})]}),e[30]=o,e[31]=y):y=e[31];const P=r?.description||"";let b;e[32]!==o||e[33]!==P?(b=t.jsx(ie,{form:o,name:"description",label:"Descrição Completa",htmlValue:P}),e[32]=o,e[33]=P,e[34]=b):b=e[34];const R=r?"Atualizar":"Cadastrar";let N;e[35]!==R?(N=t.jsxs(T,{type:"submit",children:[R," Produto"]}),e[35]=R,e[36]=N):N=e[36];let w;e[37]!==m||e[38]!==_||e[39]!==y||e[40]!==b||e[41]!==N?(w=t.jsxs("form",{onSubmit:m,className:"space-y-6",children:[_,y,b,N]}),e[37]=m,e[38]=_,e[39]=y,e[40]=b,e[41]=N,e[42]=w):w=e[42];let k;return e[43]!==o||e[44]!==w?(k=t.jsx(X,{...o,children:w}),e[43]=o,e[44]=w,e[45]=k):k=e[45],k}function ge(s){return t.jsx(oe,{value:s.id.toString(),children:s.title},s.id)}function fe(s){const{field:e}=s;return t.jsxs(M,{children:[t.jsx(A,{children:"Nome do Produto"}),t.jsx(L,{children:t.jsx(Z,{...e})}),t.jsx(U,{})]})}function he(s){return s!==void 0}function xe(s){return s.file}function je(s){return{preview:s.url||s,file:void 0,id:s.id}}export{Se as C};
